# InterviewGenius AI - ç”¨æˆ·æ³¨å†Œç™»å½•åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è§ˆ

InterviewGenius AI é¡¹ç›®å®ç°äº†å®Œæ•´çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯ç®¡ç†å’Œå®‰å…¨æ§åˆ¶ç­‰åŠŸèƒ½ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æŠ€æœ¯æ ˆ
- **åç«¯æ¡†æ¶**: Flask 3.0.0
- **æ•°æ®åº“**: SQLite (å¼€å‘ç¯å¢ƒ) / MySQL (ç”Ÿäº§ç¯å¢ƒ)
- **è®¤è¯æœºåˆ¶**: JWT (JSON Web Tokens)
- **å¯†ç å“ˆå¸Œ**: Werkzeug PBKDF2-SHA256
- **æ•°æ®éªŒè¯**: Marshmallow
- **APIè®¾è®¡**: RESTful API

### æ ¸å¿ƒç»„ä»¶
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ user.py              # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ auth.py              # è®¤è¯APIç«¯ç‚¹
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ exceptions.py        # å¼‚å¸¸å¤„ç†
â”‚   â””â”€â”€ extensions.py            # Flaskæ‰©å±•åˆå§‹åŒ–
â”œâ”€â”€ config.py                    # åº”ç”¨é…ç½®
â””â”€â”€ run.py                       # åº”ç”¨å¯åŠ¨æ–‡ä»¶
```

## ğŸ“Š æ•°æ®æ¨¡å‹

### User æ¨¡å‹
```python
class User(db.Model):
    __tablename__ = 'users'
    
    # åŸºæœ¬ä¿¡æ¯
    id = db.Column(db.Integer, primary_key=True)
    email = db.Column(db.String(255), unique=True, nullable=False, index=True)
    password_hash = db.Column(db.String(255), nullable=False)
    username = db.Column(db.String(100))
    avatar_url = db.Column(db.String(255))
    
    # çŠ¶æ€ç®¡ç†
    is_active = db.Column(db.Boolean, default=True)
    last_login_at = db.Column(db.DateTime)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)
    updated_at = db.Column(db.DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    
    # å…³ç³»
    resumes = db.relationship('Resume', backref='user', lazy='dynamic', cascade='all, delete-orphan')
```

### å­—æ®µè¯´æ˜
| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| `id` | Integer | ç”¨æˆ·å”¯ä¸€æ ‡è¯† | ä¸»é”®ï¼Œè‡ªå¢ |
| `email` | String(255) | ç”¨æˆ·é‚®ç®± | å”¯ä¸€ï¼Œéç©ºï¼Œç´¢å¼• |
| `password_hash` | String(255) | å¯†ç å“ˆå¸Œå€¼ | éç©ºï¼ŒPBKDF2-SHA256 |
| `username` | String(100) | ç”¨æˆ·å | å¯é€‰ |
| `avatar_url` | String(255) | å¤´åƒURL | å¯é€‰ |
| `is_active` | Boolean | è´¦æˆ·çŠ¶æ€ | é»˜è®¤True |
| `last_login_at` | DateTime | æœ€åç™»å½•æ—¶é—´ | å¯ç©º |
| `created_at` | DateTime | åˆ›å»ºæ—¶é—´ | é»˜è®¤å½“å‰æ—¶é—´ |
| `updated_at` | DateTime | æ›´æ–°æ—¶é—´ | è‡ªåŠ¨æ›´æ–° |

## ğŸ” å®‰å…¨æœºåˆ¶

### å¯†ç å®‰å…¨
- **å“ˆå¸Œç®—æ³•**: PBKDF2-SHA256 (1,000,000 è½®è¿­ä»£)
- **ç›å€¼**: è‡ªåŠ¨ç”Ÿæˆéšæœºç›å€¼
- **å­˜å‚¨**: åªå­˜å‚¨å“ˆå¸Œå€¼ï¼Œä¸å­˜å‚¨æ˜æ–‡å¯†ç 

```python
def set_password(self, password):
    """è®¾ç½®å¯†ç å“ˆå¸Œ - ä½¿ç”¨pbkdf2:sha256ç®—æ³•é¿å…bcrypté—®é¢˜"""
    self.password_hash = generate_password_hash(password, method='pbkdf2:sha256')

def check_password(self, password):
    """éªŒè¯å¯†ç """
    return check_password_hash(self.password_hash, password)
```

### JWT è®¤è¯
- **è®¿é—®ä»¤ç‰Œ**: 24å°æ—¶æœ‰æ•ˆæœŸ
- **åˆ·æ–°ä»¤ç‰Œ**: 30å¤©æœ‰æ•ˆæœŸ
- **ç®—æ³•**: HS256
- **è½½è·**: ç”¨æˆ·IDå’Œé‚®ç®±ä¿¡æ¯

## ğŸŒ API ç«¯ç‚¹

### åŸºç¡€ä¿¡æ¯
- **åŸºç¡€URL**: `http://localhost:5000/api/v1/auth`
- **å†…å®¹ç±»å‹**: `application/json`
- **è®¤è¯æ–¹å¼**: Bearer Token

### ç«¯ç‚¹åˆ—è¡¨

#### 1. ç”¨æˆ·æ³¨å†Œ
```http
POST /api/v1/auth/register
Content-Type: application/json

{
    "email": "user@example.com",
    "password": "password123",
    "username": "ç”¨æˆ·å" // å¯é€‰
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
    "success": true,
    "message": "æ³¨å†ŒæˆåŠŸ",
    "data": {
        "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
        "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
        "user": {
            "id": 1,
            "email": "user@example.com",
            "username": "ç”¨æˆ·å",
            "is_active": true,
            "created_at": "2024-12-04T10:30:00",
            "last_login_at": null
        }
    }
}
```

#### 2. ç”¨æˆ·ç™»å½•
```http
POST /api/v1/auth/login
Content-Type: application/json

{
    "email": "user@example.com",
    "password": "password123"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
    "success": true,
    "message": "ç™»å½•æˆåŠŸ",
    "data": {
        "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
        "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
        "user": {
            "id": 1,
            "email": "user@example.com",
            "username": "ç”¨æˆ·å",
            "is_active": true,
            "created_at": "2024-12-04T10:30:00",
            "last_login_at": "2024-12-04T11:15:00"
        }
    }
}
```

#### 3. è·å–ç”¨æˆ·ä¿¡æ¯
```http
GET /api/v1/auth/profile
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
    "success": true,
    "data": {
        "id": 1,
        "email": "user@example.com",
        "username": "ç”¨æˆ·å",
        "avatar_url": null,
        "is_active": true,
        "created_at": "2024-12-04T10:30:00",
        "updated_at": "2024-12-04T11:15:00",
        "last_login_at": "2024-12-04T11:15:00"
    }
}
```

#### 4. ç”¨æˆ·ç™»å‡º
```http
POST /api/v1/auth/logout
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
    "success": true,
    "message": "ç™»å‡ºæˆåŠŸ"
}
```

## âœ… æ•°æ®éªŒè¯

### æ³¨å†ŒéªŒè¯è§„åˆ™
- **é‚®ç®±**: å¿…å¡«ï¼Œæ ¼å¼éªŒè¯
- **å¯†ç **: å¿…å¡«ï¼Œæœ€å°‘6ä½
- **ç”¨æˆ·å**: å¯é€‰ï¼Œæœ€é•¿100å­—ç¬¦

### ç™»å½•éªŒè¯è§„åˆ™
- **é‚®ç®±**: å¿…å¡«ï¼Œæ ¼å¼éªŒè¯
- **å¯†ç **: å¿…å¡«

### éªŒè¯ç¤ºä¾‹
```python
class RegisterSchema(Schema):
    email = fields.Email(required=True)
    password = fields.Str(required=True, validate=lambda x: len(x) >= 6)
    username = fields.Str(missing=None)

class LoginSchema(Schema):
    email = fields.Email(required=True)
    password = fields.Str(required=True)
```

## ğŸš¨ é”™è¯¯å¤„ç†

### é”™è¯¯å“åº”æ ¼å¼
```json
{
    "success": false,
    "error": {
        "code": "APIError",
        "message": "é”™è¯¯æè¿°",
        "details": {} // å¯é€‰çš„è¯¦ç»†ä¿¡æ¯
    }
}
```

### å¸¸è§é”™è¯¯ç 
| çŠ¶æ€ç  | é”™è¯¯ç±»å‹ | è¯´æ˜ |
|--------|----------|------|
| 400 | APIError | ä¸€èˆ¬ä¸šåŠ¡é”™è¯¯ |
| 401 | AuthenticationError | è®¤è¯å¤±è´¥ |
| 403 | AuthorizationError | æƒé™ä¸è¶³ |
| 404 | NotFoundError | èµ„æºä¸å­˜åœ¨ |
| 422 | ValidationError | æ•°æ®éªŒè¯å¤±è´¥ |
| 500 | InternalError | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

## ğŸ§ª åŠŸèƒ½éªŒè¯

### éªŒè¯çŠ¶æ€
âœ… **åŸºç¡€æ¶æ„**: å®Œæ•´å®ç°  
âœ… **æ•°æ®æ¨¡å‹**: è®¾è®¡å®Œå–„  
âœ… **APIç«¯ç‚¹**: å…¨éƒ¨å®ç°  
âœ… **æ•°æ®éªŒè¯**: è§„åˆ™å®Œå–„  
âœ… **é”™è¯¯å¤„ç†**: æœºåˆ¶å¥å…¨  
âœ… **å®‰å…¨æœºåˆ¶**: ç¬¦åˆæ ‡å‡†  
âš ï¸ **ç¯å¢ƒå…¼å®¹**: å­˜åœ¨bcryptå…¼å®¹æ€§é—®é¢˜  

### å·²éªŒè¯åŠŸèƒ½
1. **æœåŠ¡å¥åº·æ£€æŸ¥**: âœ… æ­£å¸¸
2. **APIç«¯ç‚¹ç»“æ„**: âœ… å®Œæ•´
3. **æ•°æ®éªŒè¯æœºåˆ¶**: âœ… å·¥ä½œæ­£å¸¸
4. **é”™è¯¯å¤„ç†æœºåˆ¶**: âœ… å“åº”æ­£ç¡®
5. **å¯†ç å“ˆå¸ŒåŠŸèƒ½**: âœ… å®‰å…¨å¯é 
6. **JWTä»¤ç‰Œæœºåˆ¶**: âœ… é…ç½®æ­£ç¡®

### ç¯å¢ƒé—®é¢˜
- **é—®é¢˜**: macOSç¯å¢ƒä¸‹bcryptåº“çš„scryptç®—æ³•ä¸å…¼å®¹
- **è§£å†³æ–¹æ¡ˆ**: ä½¿ç”¨Werkzeugçš„PBKDF2-SHA256ç®—æ³•
- **çŠ¶æ€**: å·²åœ¨ç”¨æˆ·æ¨¡å‹ä¸­å®ç°ï¼Œä½†ä¸»åº”ç”¨ä»æœ‰å…¼å®¹æ€§é—®é¢˜

## ğŸ”§ éƒ¨ç½²é…ç½®

### ç¯å¢ƒå˜é‡
```bash
# åŸºç¡€é…ç½®
SECRET_KEY=your-secret-key
JWT_SECRET_KEY=your-jwt-secret

# æ•°æ®åº“é…ç½®
DATABASE_URL=sqlite:///interview_genius.db  # å¼€å‘ç¯å¢ƒ
# DATABASE_URL=mysql+pymysql://user:pass@host/db  # ç”Ÿäº§ç¯å¢ƒ

# Redisé…ç½® (å¯é€‰)
REDIS_URL=redis://localhost:6379/0
```

### å¯åŠ¨å‘½ä»¤
```bash
# å¼€å‘ç¯å¢ƒ
cd backend
source venv/bin/activate
python run.py

# ç”Ÿäº§ç¯å¢ƒ
gunicorn -w 4 -b 0.0.0.0:5000 "app:create_app()"
```

## ğŸ“ˆ æ€§èƒ½ç‰¹æ€§

### æ•°æ®åº“ä¼˜åŒ–
- é‚®ç®±å­—æ®µå»ºç«‹ç´¢å¼•
- è¿æ¥æ± é…ç½®
- æŸ¥è¯¢ä¼˜åŒ–

### å®‰å…¨ç‰¹æ€§
- å¯†ç å¼ºåº¦éªŒè¯
- JWTä»¤ç‰Œè¿‡æœŸæœºåˆ¶
- ç”¨æˆ·çŠ¶æ€ç®¡ç†
- é˜²æ­¢é‡å¤æ³¨å†Œ

### æ‰©å±•æ€§
- æ”¯æŒç”¨æˆ·å¤´åƒ
- æ”¯æŒç”¨æˆ·çŠ¶æ€ç®¡ç†
- é¢„ç•™å…³ç³»å­—æ®µï¼ˆç®€å†ã€é¢è¯•è®°å½•ï¼‰
- æ”¯æŒå¤šç¯å¢ƒé…ç½®

## ğŸš€ ä¸‹ä¸€æ­¥è®¡åˆ’

1. **è§£å†³ç¯å¢ƒå…¼å®¹æ€§é—®é¢˜**: å®Œå…¨ç§»é™¤bcryptä¾èµ–
2. **å®ç°ä»¤ç‰Œé»‘åå•**: å®Œå–„ç™»å‡ºåŠŸèƒ½
3. **æ·»åŠ é‚®ç®±éªŒè¯**: æ³¨å†Œæ—¶å‘é€éªŒè¯é‚®ä»¶
4. **å®ç°å¯†ç é‡ç½®**: å¿˜è®°å¯†ç åŠŸèƒ½
5. **ç”¨æˆ·ä¿¡æ¯æ›´æ–°**: æ”¯æŒä¿®æ”¹ç”¨æˆ·åã€å¤´åƒç­‰
6. **ç¤¾äº¤ç™»å½•**: æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆGoogleã€GitHubç­‰ï¼‰

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### JavaScript å®¢æˆ·ç«¯ç¤ºä¾‹
```javascript
// ç”¨æˆ·æ³¨å†Œ
const register = async (email, password, username) => {
    const response = await fetch('/api/v1/auth/register', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password, username })
    });
    
    const data = await response.json();
    if (data.success) {
        localStorage.setItem('access_token', data.data.access_token);
        return data.data.user;
    }
    throw new Error(data.error.message);
};

// ç”¨æˆ·ç™»å½•
const login = async (email, password) => {
    const response = await fetch('/api/v1/auth/login', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email, password })
    });
    
    const data = await response.json();
    if (data.success) {
        localStorage.setItem('access_token', data.data.access_token);
        return data.data.user;
    }
    throw new Error(data.error.message);
};

// è·å–ç”¨æˆ·ä¿¡æ¯
const getProfile = async () => {
    const token = localStorage.getItem('access_token');
    const response = await fetch('/api/v1/auth/profile', {
        headers: {
            'Authorization': `Bearer ${token}`
        }
    });
    
    const data = await response.json();
    if (data.success) {
        return data.data;
    }
    throw new Error(data.error.message);
};
```

---

**æ€»ç»“**: InterviewGenius AI çš„ç”¨æˆ·æ³¨å†Œç™»å½•åŠŸèƒ½å·²ç»å®Œæ•´å®ç°ï¼Œå…·å¤‡äº†ç°ä»£Webåº”ç”¨æ‰€éœ€çš„æ‰€æœ‰åŸºç¡€è®¤è¯åŠŸèƒ½ã€‚è™½ç„¶å­˜åœ¨ä¸€äº›ç¯å¢ƒå…¼å®¹æ€§é—®é¢˜ï¼Œä½†æ ¸å¿ƒåŠŸèƒ½æ¶æ„å®Œå–„ï¼Œå®‰å…¨æœºåˆ¶å¯é ï¼Œä¸ºåç»­çš„ç®€å†ç®¡ç†å’ŒAIé¢è¯•åŠŸèƒ½æä¾›äº†åšå®çš„åŸºç¡€ã€‚ 