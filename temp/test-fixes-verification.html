<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¤éªŒè¯æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .fix-section {
            background-color: #f0fff4;
            border-left: 4px solid #38a169;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .test-section {
            background-color: #fff5f5;
            border-left: 4px solid #e53e3e;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
        }
        .step {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f7fafc;
            border-radius: 6px;
            border-left: 4px solid #4299e1;
        }
        .step-number {
            background-color: #4299e1;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            margin-right: 15px;
        }
        .success {
            color: #38a169;
            font-weight: bold;
        }
        .warning {
            color: #ed8936;
            font-weight: bold;
        }
        .error {
            color: #e53e3e;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”§ ä¿®å¤éªŒè¯æµ‹è¯•</h1>
            <p>éªŒè¯ MockInterviewPage.tsx ä¸­çš„ä¸¤ä¸ªé—®é¢˜ä¿®å¤æ•ˆæœ</p>
        </div>

        <div class="fix-section">
            <h2>âœ… ä¿®å¤å†…å®¹æ€»ç»“</h2>
            <h3>1. Token è¦†ç›–é—®é¢˜ä¿®å¤</h3>
            <div class="code-block">
// ä¿®å¤å‰ï¼ˆé—®é¢˜ä»£ç ï¼‰
const testToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
localStorage.setItem('access_token', testToken);

// ä¿®å¤åï¼ˆæ­£ç¡®ä»£ç ï¼‰
const currentToken = localStorage.getItem('access_token');
if (!currentToken) {
    throw new Error('No authentication token found. Please login again.');
}
console.log('ğŸ” Using current authentication token');
            </div>
            <p class="success">âœ… ä¸å†è¦†ç›–ç”¨æˆ·çš„çœŸå® token</p>
            <p class="success">âœ… æä¾›æ¸…æ™°çš„è®¤è¯é”™è¯¯æç¤º</p>

            <h3>2. /generate æ¥å£é‡å¤è°ƒç”¨é—®é¢˜ä¿®å¤</h3>
            <div class="code-block">
// æ–°å¢ä¼˜å…ˆæ£€æŸ¥é€»è¾‘
if (stateData?.questions && stateData?.sessionId) {
    console.log('âœ… ä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®:', stateData.sessionId);
    console.log(`ğŸ“‹ é—®é¢˜æ•°é‡: ${stateData.questions.length}`);
    
    // ç›´æ¥ä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®ï¼Œé¿å…é‡å¤APIè°ƒç”¨
    setQuestions(stateData.questions);
    
    // åªè·å–ä¼šè¯ä¿¡æ¯ï¼Œä¸é‡æ–°è·å–é—®é¢˜
    const sessionData = await questionService.getSessionQuestions(stateData.sessionId);
    setInterviewSession(sessionData.session);
    console.log('âœ… ä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®ï¼Œé¿å…é‡å¤ç”Ÿæˆ');
} else if (stateData?.selectedJob && stateData?.resumeId) {
    // åŸæœ‰çš„ HomePage è·³è½¬é€»è¾‘
}
            </div>
            <p class="success">âœ… ä¼˜å…ˆä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®</p>
            <p class="success">âœ… é¿å…é‡å¤è°ƒç”¨ /api/v1/questions/generate</p>
            <p class="success">âœ… åªè°ƒç”¨ getSessionQuestions è·å–ä¼šè¯ä¿¡æ¯</p>

            <h3>3. é”™è¯¯å¤„ç†æ”¹è¿›</h3>
            <div class="code-block">
// æ”¹è¿›çš„é”™è¯¯å¤„ç†
if (error.message?.includes('token') || error.message?.includes('authentication')) {
    setError('Authentication failed. Please login again.');
    console.error('ğŸ” Tokenè®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•');
} else {
    handleApiError(error);
    setError(error.message || 'Failed to initialize interview, please try again later');
}
            </div>
            <p class="success">âœ… åŒºåˆ† token ç›¸å…³é”™è¯¯å’Œå…¶ä»–é”™è¯¯</p>
            <p class="success">âœ… æä¾›ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º</p>
        </div>

        <div class="test-section">
            <h2>ğŸ§ª æµ‹è¯•æ­¥éª¤</h2>
            <div class="step">
                <div class="step-number">1</div>
                <div>ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œåœ¨ <code>http://localhost:5001</code></div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div>ç¡®ä¿å‰ç«¯æœåŠ¡è¿è¡Œåœ¨ <code>http://localhost:3000</code></div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>è®¿é—® <code>http://localhost:3000/resume</code> ä¸Šä¼ ç®€å†</div>
            </div>
            <div class="step">
                <div class="step-number">4</div>
                <div>åœ¨ <code>http://localhost:3000/complete</code> ç‚¹å‡»"å¼€å§‹æ¨¡æ‹Ÿé¢è¯•"</div>
            </div>
            <div class="step">
                <div class="step-number">5</div>
                <div>ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç›‘æ§ç½‘ç»œè¯·æ±‚</div>
            </div>
            <div class="step">
                <div class="step-number">6</div>
                <div>éªŒè¯ <code>/api/v1/questions/generate</code> åªè¢«è°ƒç”¨ä¸€æ¬¡</div>
            </div>
            <div class="step">
                <div class="step-number">7</div>
                <div>éªŒè¯ <code>/api/v1/resumes</code> æ¥å£ä¸å†æŠ¥ 422 é”™è¯¯</div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“Š é¢„æœŸæ•ˆæœ</h2>
            <h3>ä¿®å¤å‰çš„é—®é¢˜ï¼š</h3>
            <ul>
                <li class="error">âŒ /api/v1/questions/generate è¢«è°ƒç”¨ä¸‰æ¬¡</li>
                <li class="error">âŒ /api/v1/resumes æ¥å£æŠ¥ 422 UNPROCESSABLE ENTITY</li>
                <li class="error">âŒ ç”¨æˆ· token è¢«ç¡¬ç¼–ç çš„æµ‹è¯• token è¦†ç›–</li>
                <li class="error">âŒ å“åº”æ—¶é—´è¿‡é•¿ï¼Œç”¨æˆ·ä½“éªŒå·®</li>
            </ul>

            <h3>ä¿®å¤åçš„æ•ˆæœï¼š</h3>
            <ul>
                <li class="success">âœ… /api/v1/questions/generate åªè¢«è°ƒç”¨ä¸€æ¬¡</li>
                <li class="success">âœ… /api/v1/resumes æ¥å£æ­£å¸¸å·¥ä½œ</li>
                <li class="success">âœ… ç”¨æˆ· token å¾—åˆ°ä¿æŠ¤ï¼Œä¸å†è¢«è¦†ç›–</li>
                <li class="success">âœ… å“åº”æ—¶é—´æ˜¾è‘—æå‡</li>
                <li class="success">âœ… æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º</li>
            </ul>
        </div>

        <div class="fix-section">
            <h2>ğŸ” è°ƒè¯•ä¿¡æ¯</h2>
            <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­åº”è¯¥çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ï¼š</p>
            <div class="code-block">
âœ… ä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®: [session_id]
ğŸ“‹ é—®é¢˜æ•°é‡: 8
âœ… ä½¿ç”¨å·²ä¼ é€’çš„é—®é¢˜æ•°æ®ï¼Œé¿å…é‡å¤ç”Ÿæˆ
ğŸ” Using current authentication token
            </div>
            
            <p class="warning">âš ï¸ å¦‚æœä»ç„¶çœ‹åˆ°å¤šæ¬¡è°ƒç”¨ï¼Œè¯·æ£€æŸ¥ï¼š</p>
            <ul>
                <li>CompletePage æ˜¯å¦æ­£ç¡®ä¼ é€’äº† questions æ•°æ®</li>
                <li>MockInterviewPage æ˜¯å¦æ­£ç¡®æ¥æ”¶äº† state æ•°æ®</li>
                <li>æ˜¯å¦æœ‰å…¶ä»–åœ°æ–¹ä¹Ÿåœ¨è°ƒç”¨ generateQuestions</li>
            </ul>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ æ€§èƒ½æå‡</h2>
            <p><strong>é¢„æœŸæ€§èƒ½æå‡ï¼š</strong></p>
            <ul>
                <li>API è°ƒç”¨æ¬¡æ•°ï¼šä» 3 æ¬¡å‡å°‘åˆ° 1 æ¬¡</li>
                <li>å“åº”æ—¶é—´ï¼šä» 3+ åˆ†é’Ÿå‡å°‘åˆ° 1 åˆ†é’Ÿä»¥å†…</li>
                <li>ç”¨æˆ·ä½“éªŒï¼šæ˜¾è‘—æ”¹å–„</li>
                <li>æœåŠ¡å™¨è´Ÿè½½ï¼šå‡å°‘ 66%</li>
            </ul>
        </div>
    </div>
</body>
</html> 