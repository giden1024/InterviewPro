# AWS EC2 SSH连接故障排除清单

## 🚨 当前问题
- SSH连接到 3.144.27.91 超时
- 所有端口（22, 80, 443, 5001）都无法访问
- 密钥文件权限正确但连接失败

## 📋 AWS控制台检查清单

### 1. EC2实例状态检查
登录AWS控制台 → EC2 → 实例

**检查项目：**
- [ ] 实例状态：必须是 "running"（运行中）
- [ ] 实例状态检查：2/2 检查通过
- [ ] 公有IPv4地址：确认是 3.144.27.91
- [ ] 私有IPv4地址：记录下来
- [ ] 可用区：记录下来
- [ ] VPC ID：记录下来
- [ ] 子网ID：记录下来

### 2. 安全组配置检查
点击实例 → 安全 → 安全组

**必需的入站规则：**
```
类型        协议    端口范围    源            描述
SSH         TCP     22         0.0.0.0/0     SSH access
HTTP        TCP     80         0.0.0.0/0     HTTP access  
HTTPS       TCP     443        0.0.0.0/0     HTTPS access
自定义TCP    TCP     5001       0.0.0.0/0     API access
```

**检查步骤：**
- [ ] 点击安全组ID
- [ ] 查看"入站规则"标签
- [ ] 确认上述规则都存在
- [ ] 确认源是 0.0.0.0/0 (允许所有IP)

### 3. 网络ACL检查
EC2 → 网络和安全 → 网络ACL

**检查步骤：**
- [ ] 找到实例所在子网的网络ACL
- [ ] 检查入站规则是否允许SSH (端口22)
- [ ] 检查出站规则是否允许响应流量

### 4. 路由表检查
EC2 → 网络和安全 → 路由表

**检查步骤：**
- [ ] 找到实例所在子网的路由表
- [ ] 确认有到互联网网关(IGW)的路由: 0.0.0.0/0 → igw-xxxxx

### 5. 密钥对验证
EC2 → 网络和安全 → 密钥对

**检查步骤：**
- [ ] 确认密钥对名称与实例关联的密钥对匹配
- [ ] 确认您的.pem文件对应正确的密钥对

## 🔧 常见解决方案

### 解决方案1: 修复安全组
```bash
# 如果您有AWS CLI配置，可以运行：
aws ec2 describe-instances --instance-ids i-xxxxxxxxx
aws ec2 describe-security-groups --group-ids sg-xxxxxxxxx
```

### 解决方案2: 重启实例
在AWS控制台中：
1. 选择实例
2. 实例状态 → 重启实例
3. 等待实例重新启动

### 解决方案3: 检查系统日志
在AWS控制台中：
1. 选择实例
2. 操作 → 监控和故障排除 → 获取系统日志
3. 查看是否有启动错误

### 解决方案4: 使用EC2 Instance Connect
如果SSH仍然失败，可以尝试：
1. 在AWS控制台中选择实例
2. 连接 → EC2 Instance Connect
3. 直接在浏览器中连接

## 📞 获取帮助信息

请收集以下信息：

1. **实例信息：**
   - 实例ID: i-xxxxxxxxx
   - 实例状态: running/stopped/pending
   - 公网IP: 3.144.27.91
   - 私网IP: 10.x.x.x
   - 实例类型: t2.micro/t3.small等

2. **网络信息：**
   - VPC ID: vpc-xxxxxxxxx
   - 子网ID: subnet-xxxxxxxxx
   - 安全组ID: sg-xxxxxxxxx
   - 密钥对名称: aws-myy-rsa

3. **错误信息：**
   - SSH错误: "Operation timed out"
   - 测试时间: 现在
   - 本地IP: (可通过 curl ifconfig.me 获取)

## 🎯 下一步行动

1. **立即检查：** 登录AWS控制台，按照上述清单逐项检查
2. **记录信息：** 记录实例ID、安全组ID等关键信息
3. **尝试修复：** 根据检查结果修复配置问题
4. **重新测试：** 修复后重新尝试SSH连接
5. **备选方案：** 如果SSH仍然失败，考虑使用EC2 Instance Connect 