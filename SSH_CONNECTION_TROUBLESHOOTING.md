# SSH连接故障排除指南

**问题状态**: 无法SSH连接到AWS服务器 (3.14.247.189)  
**时间**: 2025-07-13 12:25  
**测试结果**: 所有连接方法均失败

## 🚨 **诊断结果**

### 网络连通性测试
- **PING测试**: 100% 丢包 ❌
- **SSH连接**: 操作超时 ❌
- **Telnet端口22**: 连接失败 ❌
- **优化SSH脚本**: 5次重试全部失败 ❌

## 🔍 **可能的原因**

### 1. **服务器状态问题**
- ✅ **CPU 100%**: 系统完全无响应
- ✅ **内存耗尽**: 导致系统崩溃
- ✅ **SSH服务停止**: sshd进程可能已死
- ✅ **系统hang**: 内核级别的死机

### 2. **网络问题**
- ⚠️ **AWS安全组**: 可能SSH端口被意外关闭
- ⚠️ **实例状态**: EC2实例可能停止运行
- ⚠️ **网络ACL**: 网络访问控制列表问题
- ⚠️ **区域网络**: AWS区域网络问题

### 3. **防火墙问题**
- ⚠️ **本地防火墙**: macOS防火墙阻止连接
- ⚠️ **ISP限制**: 网络提供商限制SSH端口
- ⚠️ **服务器防火墙**: iptables规则变更

## 🛠️ **解决方案**

### 方案1: AWS控制台操作（推荐）

#### 1.1 检查实例状态
```
1. 登录AWS控制台
2. 进入EC2服务
3. 查看实例列表
4. 检查实例状态：
   - Instance State: running/stopped/terminated
   - Status Checks: 2/2 checks passed
   - CPU/Memory 使用率图表
```

#### 1.2 通过控制台连接
```
1. 选择你的EC2实例
2. 点击 "Connect" 按钮
3. 选择 "EC2 Instance Connect"
4. 点击 "Connect" 建立浏览器SSH连接
```

#### 1.3 检查安全组设置
```
1. 在EC2实例详情中查看Security Groups
2. 确保以下端口开放：
   - SSH (22): 0.0.0.0/0
   - HTTP (80): 0.0.0.0/0  
   - HTTPS (443): 0.0.0.0/0
```

### 方案2: 实例重启

#### 2.1 软重启
```
1. 在EC2控制台选择实例
2. Instance State → Reboot instance
3. 等待2-3分钟
4. 重新尝试SSH连接
```

#### 2.2 强制重启
```
如果软重启无效：
1. Instance State → Stop instance
2. 等待实例完全停止
3. Instance State → Start instance
4. 等待实例启动完成
```

### 方案3: AWS Systems Manager

如果配置了SSM：
```
1. 使用AWS CLI: aws ssm start-session --target i-实例ID
2. 或通过控制台Systems Manager → Session Manager
```

### 方案4: 网络诊断

#### 4.1 检查本地网络
```bash
# 检查DNS解析
nslookup 3.14.247.189

# 检查路由
traceroute 3.14.247.189

# 测试其他AWS服务
ping aws.amazon.com
```

#### 4.2 尝试不同网络
```
1. 使用手机热点
2. 使用VPN
3. 从不同位置尝试连接
```

## 🚀 **立即执行计划**

### 第一步: 检查实例状态
1. **登录AWS控制台**
2. **查看EC2实例运行状态**
3. **检查CPU/内存使用率图表**

### 第二步: 尝试控制台连接
1. **使用EC2 Instance Connect**
2. **如果连接成功，执行**:
   ```bash
   # 检查系统状态
   top
   free -h
   df -h
   
   # 停止高负载服务
   cd /home/ubuntu/InterviewPro
   docker-compose down
   docker system prune -f
   ```

### 第三步: 如果控制台也无法连接
1. **重启EC2实例**
2. **等待完全启动后重试**

### 第四步: 检查安全组
1. **确保SSH端口22开放**
2. **检查源IP设置**

## 📞 **紧急联系方式**

如果所有方法都失败：
1. **AWS Support**: 如果有支持计划
2. **重新创建实例**: 从AMI快照恢复
3. **检查账单**: 确保服务未被暂停

## 🔧 **预防措施**

为避免将来出现此问题：
1. **设置CloudWatch监控和报警**
2. **配置多种连接方式** (SSH + SSM)
3. **定期备份系统状态**
4. **实施资源限制和监控**

---

**下一步建议**: 立即通过AWS控制台检查实例状态，这是当前最可靠的连接方式。 