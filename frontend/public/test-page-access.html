<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¡µé¢è®¿é—®æµ‹è¯•</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 20px; 
            background: #f5f5f5;
        }
        .test-section { 
            background: white; 
            padding: 20px; 
            margin: 15px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status { 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .test-result { 
            margin: 10px 0; 
            padding: 10px; 
            border-radius: 4px; 
            font-family: monospace;
        }
        h1 { color: #333; text-align: center; }
        h2 { color: #555; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
    </style>
</head>
<body>
    <h1>ğŸ§ª InterviewPro é¡µé¢è®¿é—®æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>ğŸ“Š æœåŠ¡çŠ¶æ€æ£€æŸ¥</h2>
        <button onclick="checkBackendHealth()">æ£€æŸ¥åç«¯æœåŠ¡</button>
        <button onclick="checkFrontendPages()">æ£€æŸ¥å‰ç«¯é¡µé¢</button>
        <button onclick="runFullTest()">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
        <div id="serviceStatus"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ”— é¡µé¢è®¿é—®æµ‹è¯•</h2>
        <button onclick="testPageAccess()">æµ‹è¯•é¡µé¢è®¿é—®</button>
        <div id="pageAccessResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ›  APIè¿æ¥æµ‹è¯•</h2>
        <button onclick="testAPIConnections()">æµ‹è¯•APIè¿æ¥</button>
        <div id="apiResults"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“± Mock Interview é¡µé¢æµ‹è¯•</h2>
        <button onclick="testMockInterviewPage()">æµ‹è¯•Mock Interviewé¡µé¢</button>
        <button onclick="openMockInterviewPage()">æ‰“å¼€Mock Interviewé¡µé¢</button>
        <div id="mockInterviewResults"></div>
    </div>

    <script>
        const baseURL = 'http://localhost:5001';
        const frontendURL = 'http://localhost:3000';

        function addResult(containerId, message, type = 'info') {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = message;
            container.appendChild(div);
        }

        function clearResults(containerId) {
            document.getElementById(containerId).innerHTML = '';
        }

        async function checkBackendHealth() {
            clearResults('serviceStatus');
            addResult('serviceStatus', 'ğŸ”„ æ£€æŸ¥åç«¯æœåŠ¡å¥åº·çŠ¶æ€...', 'info');
            
            try {
                const response = await fetch(`${baseURL}/health`);
                const data = await response.json();
                addResult('serviceStatus', `âœ… åç«¯æœåŠ¡æ­£å¸¸: ${data.service} - ${data.status}`, 'success');
                return true;
            } catch (error) {
                addResult('serviceStatus', `âŒ åç«¯æœåŠ¡è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                return false;
            }
        }

        async function checkFrontendPages() {
            addResult('serviceStatus', 'ğŸ”„ æ£€æŸ¥å‰ç«¯é¡µé¢...', 'info');
            
            try {
                const response = await fetch(frontendURL);
                if (response.ok) {
                    addResult('serviceStatus', 'âœ… å‰ç«¯æœåŠ¡æ­£å¸¸è¿è¡Œ', 'success');
                    return true;
                } else {
                    addResult('serviceStatus', `âš ï¸ å‰ç«¯æœåŠ¡å“åº”å¼‚å¸¸: ${response.status}`, 'warning');
                    return false;
                }
            } catch (error) {
                addResult('serviceStatus', `âŒ å‰ç«¯æœåŠ¡è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                return false;
            }
        }

        async function testPageAccess() {
            clearResults('pageAccessResults');
            const pages = [
                { name: 'Home', url: '/' },
                { name: 'Mock Interview', url: '/mock-interview' },
                { name: 'Resume', url: '/resume' },
                { name: 'Job', url: '/job' }
            ];

            for (const page of pages) {
                try {
                    addResult('pageAccessResults', `ğŸ”„ æµ‹è¯• ${page.name} é¡µé¢...`, 'info');
                    const response = await fetch(`${frontendURL}${page.url}`);
                    if (response.ok) {
                        addResult('pageAccessResults', `âœ… ${page.name} é¡µé¢å¯è®¿é—®`, 'success');
                    } else {
                        addResult('pageAccessResults', `âš ï¸ ${page.name} é¡µé¢å“åº”å¼‚å¸¸: ${response.status}`, 'warning');
                    }
                } catch (error) {
                    addResult('pageAccessResults', `âŒ ${page.name} é¡µé¢è®¿é—®å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        async function testAPIConnections() {
            clearResults('apiResults');
            const apis = [
                { name: 'å¥åº·æ£€æŸ¥', url: '/health' },
                { name: 'ç®€å†åˆ—è¡¨', url: '/api/v1/resumes' },
                { name: 'é¢è¯•è®°å½•', url: '/api/v1/interviews' }
            ];

            for (const api of apis) {
                try {
                    addResult('apiResults', `ğŸ”„ æµ‹è¯• ${api.name} API...`, 'info');
                    const response = await fetch(`${baseURL}${api.url}`);
                    const data = await response.json();
                    
                    if (response.ok) {
                        addResult('apiResults', `âœ… ${api.name} APIæ­£å¸¸`, 'success');
                    } else {
                        addResult('apiResults', `âš ï¸ ${api.name} APIå“åº”: ${response.status} - ${data.message || 'æœªçŸ¥é”™è¯¯'}`, 'warning');
                    }
                } catch (error) {
                    addResult('apiResults', `âŒ ${api.name} APIè¿æ¥å¤±è´¥: ${error.message}`, 'error');
                }
            }
        }

        async function testMockInterviewPage() {
            clearResults('mockInterviewResults');
            addResult('mockInterviewResults', 'ğŸ”„ æµ‹è¯•Mock Interviewé¡µé¢åŠŸèƒ½...', 'info');
            
            try {
                // æµ‹è¯•é¡µé¢è®¿é—®
                const pageResponse = await fetch(`${frontendURL}/mock-interview`);
                if (pageResponse.ok) {
                    addResult('mockInterviewResults', 'âœ… Mock Interviewé¡µé¢å¯è®¿é—®', 'success');
                } else {
                    addResult('mockInterviewResults', `âš ï¸ Mock Interviewé¡µé¢å“åº”å¼‚å¸¸: ${pageResponse.status}`, 'warning');
                }

                // æµ‹è¯•ç›¸å…³API
                const apiTests = [
                    { name: 'ç®€å†API', url: '/api/v1/resumes' },
                    { name: 'é¢è¯•API', url: '/api/v1/interviews' }
                ];

                for (const test of apiTests) {
                    try {
                        const response = await fetch(`${baseURL}${test.url}`);
                        if (response.ok) {
                            addResult('mockInterviewResults', `âœ… ${test.name} å¯ç”¨`, 'success');
                        } else {
                            addResult('mockInterviewResults', `âš ï¸ ${test.name} å“åº”å¼‚å¸¸: ${response.status}`, 'warning');
                        }
                    } catch (error) {
                        addResult('mockInterviewResults', `âŒ ${test.name} è¿æ¥å¤±è´¥`, 'error');
                    }
                }

            } catch (error) {
                addResult('mockInterviewResults', `âŒ Mock Interviewé¡µé¢æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function openMockInterviewPage() {
            addResult('mockInterviewResults', 'ğŸ”„ æ­£åœ¨æ‰“å¼€Mock Interviewé¡µé¢...', 'info');
            window.open(`${frontendURL}/mock-interview`, '_blank');
        }

        async function runFullTest() {
            clearResults('serviceStatus');
            clearResults('pageAccessResults');
            clearResults('apiResults');
            clearResults('mockInterviewResults');
            
            addResult('serviceStatus', 'ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´æµ‹è¯•...', 'info');
            
            // æŒ‰é¡ºåºè¿è¡Œæ‰€æœ‰æµ‹è¯•
            await checkBackendHealth();
            await checkFrontendPages();
            await testPageAccess();
            await testAPIConnections();
            await testMockInterviewPage();
            
            addResult('serviceStatus', 'âœ… å®Œæ•´æµ‹è¯•è¿è¡Œå®Œæ¯•', 'success');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€
        window.onload = function() {
            addResult('serviceStatus', 'ğŸ“‹ é¡µé¢å·²åŠ è½½ï¼Œç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•', 'info');
        };
    </script>
</body>
</html> 